/**
 * Qvet - QlikView Extension Trickster
 * 
 * @version v0.0.2
 * @author Valentyn Yakymenko <rayfesoul@gmail.com>
 * @license MIT
 */!function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=o[a]={exports:{}};t[a][0].call(l.exports,function(e){var o=t[a][1][e];return i(o?o:e)},l,l.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0}),o.QvetCore=void 0;var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=e("./native/Bookmarks"),a=e("./native/Repository"),s=e("./native/ShowFields"),c=e("./native/NewSheetObject"),u=e("./bookmark/EmailBookmark"),l="0.0.1-alpha";o.QvetCore=function(){function e(){n(this,e),this["native"]={bookmarks:{$add:r.$AddBookmark,$remove:r.$RemoveBookmark},$openRepository:a.$OpenRepository,$showFields:s.$ShowFields,$newSheetObject:c.$NewSheetObject}}return i(e,[{key:"getVersion",value:function(){return console.log("Qvet version: "+l)}},{key:"sendEmailBookmark",value:function(e,t){return new u.EmailBookmark(e,t).createBookmark().openEmailWindow()}}]),e}()},{"./bookmark/EmailBookmark":2,"./native/Bookmarks":3,"./native/NewSheetObject":4,"./native/Repository":5,"./native/ShowFields":6}],2:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();o.EmailBookmark=function(){function e(t,o){n(this,e);var i={emailSubject:"",name:"Email Bookmark",shared:!0,excludeSelections:!1,includeState:!0,notDisplayed:!1,descriptionShow:!1,descriptionMsg:"",saveInputValues:!0};this.defaulQvAjxZfc="/QvAJAXZfc/opendoc.htm?document=",this.applied=!0,this.doc=Qv.GetCurrentDocument(),this.bookmarkId="",this.emailSubject=t.emailSubject||i.emailSubject,this.name=t.name||i.name,this.shared=t.shared||i.shared,this.excludeSelections=t.excludeSelections||i.excludeSelections,this.includeState=t.includeState||i.includeState,this.notDisplayed=t.notDisplayed||i.notDisplayed,this.descriptionShow=t.descriptionShow||i.descriptionShow,this.descriptionMsg=t.descriptionMsg||i.descriptionMsg,this.saveInputValues=t.saveInputValues||i.saveInputValues,this.extraUri=o.extraUri||"",this.emailWindowMode=o.emailWindowMode||!0}return i(e,[{key:"createBookmark",value:function(){return this.doc.Bookmarks().NewBookmark(this.name,this.applied,this.shared,this.excludeSelections,this.includeState,this.notDisplayed,this.descriptionShow,this.descriptionMsg,this.saveInputValues),this.bookmarkId=this.doc.Bookmarks().BookMarks[this.doc.Bookmarks().BookMarks.length-1].value,this}},{key:"openEmailWindow",value:function(){var e=this.extraUri+this.defaulQvAjxZfc+this.doc.binder.View+this.bookmarkId,t=encodeURIComponent(e).replace(/%20/g,"%2520"),o="mailto:?subject="+this.emailSubject+"&body="+t;return this.emailWindowMode?window.location.href=o:location.href=o,this}}]),e}()},{}],3:[function(e,t,o){"use strict";function n(){Qva.ContextClientAction({clientAction:"modal",param:"bm",name:"ADDBM",binder:Qv.GetCurrentDocument().binder})}function i(){Qva.ContextClientAction({clientAction:"modal",param:"removebm",name:"REMBM",binder:Qv.GetCurrentDocument().binder})}Object.defineProperty(o,"__esModule",{value:!0}),o.$AddBookmark=n,o.$RemoveBookmark=i},{}],4:[function(e,t,o){"use strict";function n(){Qva.Mgr.menu.doAction({target:".ctx-menu-action-NEWSHEETOBJ"})}Object.defineProperty(o,"__esModule",{value:!0}),o.$NewSheetObject=n},{}],5:[function(e,t,o){"use strict";function n(){Qva.Mgr.menu.doAction({target:".ctx-menu-action-REPOSITORY"})}Object.defineProperty(o,"__esModule",{value:!0}),o.$OpenRepository=n},{}],6:[function(e,t,o){"use strict";function n(){Qva.Mgr.menu.doAction({target:".ctx-menu-action-SHOWFIELDS"})}Object.defineProperty(o,"__esModule",{value:!0}),o.$ShowFields=n},{}],7:[function(e,t,o){"use strict";var n=e("./core/Core");!function(e){"undefined"==typeof Qva&&"undefined"==typeof jQuery?console.log("Can't init Qvet because Qva/jQuery is undefined"):"undefined"==typeof Qvet?e.Qvet=new n.QvetCore:console.log("Qvet already defined.")}(window)},{"./core/Core":1}]},{},[7]);